import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Alert, AlertDescription, AlertTitle } from "@/components/ui/alert";
import { ShieldAlert, FileText, Bot } from 'lucide-react';
import Link from "next/link";


const VulnerabilityReport = () => {

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <FileText className="text-primary" />
          Vulnerability & Exploitation Report
        </CardTitle>
        <CardDescription>
          A summary of critical vulnerabilities and the methodology for exploitation. For a technical guide, see the <Link href="/REAL_WORLD_APP.md" className="underline text-accent">Real-World Application Guide</Link>.
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-6">
        <Alert variant="destructive">
            <ShieldAlert className="h-4 w-4" />
            <AlertTitle>Vulnerability 1: Hardcoded AES Key/IV</AlertTitle>
            <AlertDescription>
                <p>All WebSocket traffic is encrypted using AES-CBC with a hardcoded key and IV: <code className="font-code text-xs bg-destructive-foreground/20 p-1 rounded">pbc_efgfi1@l0nwp</code>. This key was extracted from the client-side source code, allowing for full decryption and re-encryption of any game-related communication.</p>
                <p className="mt-2"><strong>Exploitation:</strong> The 'WS Traffic Decryptor' and 'Decryption Quick Verify' tabs use this key to provide a live, decrypted view of game traffic and allow for manual decryption of any ciphertext.</p>
            </AlertDescription>
        </Alert>
        <Alert variant="destructive">
            <ShieldAlert className="h-4 w-4" />
            <AlertTitle>Vulnerability 2: Weak Custom URL Encoding</AlertTitle>
            <AlertDescription>
                <p>Sensitive data in the game's launch URL (e.g., `dynamicpass`, `userid`) is obfuscated with a weak substitution cipher. This cipher is easily reversible, exposing critical session information needed to authenticate forged WebSocket commands.</p>
                <p className="mt-2"><strong>Exploitation:</strong> The 'URL Parameter Tampering' card includes a utility to encode and decode payloads using this weak cipher, enabling session manipulation and hijacking.</p>
            </AlertDescription>
        </Alert>
         <Alert variant="destructive">
            <ShieldAlert className="h-4 w-4" />
            <AlertTitle>Vulnerability 3: Inferred Trust of Client Payloads</AlertTitle>
            <AlertDescription>
                <p>The game server appears to trust client-side declarations of events, such as jackpot wins. By analyzing decrypted traffic, we can identify the structure of a jackpot win command (mainID: 100, subID: 142) and forge our own.</p>
                 <p className="mt-2"><strong>Exploitation:</strong> The 'Command Forging' panel allows for the construction, encryption, and injection of a forged jackpot win payload. The session data required for this is automatically gathered by the 'Site Webview' recon simulation.</p>
            </AlertDescription>
        </Alert>
        <Card className="bg-secondary">
          <CardHeader>
            <CardTitle className="flex items-center gap-2 text-lg"><Bot className="text-accent" /> AI-Powered Payload Generation</CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-sm text-muted-foreground">Beyond fixed templates, CipherLens uses a generative AI model to construct novel exploitation payloads from natural language descriptions. By providing it with the known command structure and session data, the AI can infer the correct parameters to achieve a desired outcome, such as triggering a win for a specific user ID with a custom score.</p>
            <p className="text-sm text-muted-foreground mt-2">This is demonstrated in the 'With AI' tab of the 'Command Forging' tool, where you can describe a payload and have the AI generate and encrypt it instantly.</p>
          </CardContent>
        </Card>
      </CardContent>
    </Card>
  );
};

export default VulnerabilityReport;
